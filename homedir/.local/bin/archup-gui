#!/usr/bin/env bash

set -x
set -e

archup

TOOL="yay"

COMMON=(networkmanager virt-manager virt-viewer)
GUIAPPS=(vlc firefox-nightly google-chrome-dev firefox-nightly skypeforlinux-bin)
GUIPKGS=(gtk-them-arc-git numix-circle-icon-theme-git)
FONTS=(ttf-ms-fonts ttf-emojione ttf-fira-mono)
GNOMEPKGS=(gdm gedit eog cheese remmina \
    gnome-{boxes,builder,control-center,screenshot,session,shell,tweak-tool} \
    chrome-gnome-shell)
KDEPKGS=(plasma plasma-desktop plasma-wayland-session \
    plasma5-applets-redshift-control plasma-nm \
    kdemultimedia-kmix kscreen powerdevil bluedevil kwalletmanager \
    kate spectacle \
    breeze-gtk kde-gtk-config)

EXCEPTIONAL=(visual-studio-code-insiders)

"${TOOL}" -S --needed --noconfirm \
   ${COMMON[@]} \
   ${GUIAPPS[@]} \
   ${GUIPKGS[@]} \
   ${FONTS[@]} \
   ${GNOMEPKGS[@]} \
   #${KDEPKGS[@]}

# yay doesn't respect MAKEPKG... and it doesn't actually fail when vs-code-insiders fails the check
# ugh, there's no tool that really gets it all right :/
# note the use of `yaourt` here. don't @ me.
MAKEPKG="makepkg --skipinteg" yaourt -S --needed --noconfirm "${EXCEPTIONAL[@]}"

sudo systemctl enable gdm
sudo systemctl enable NetworkManager
sudo systemctl enable bluetooth

sudo gpasswd -a ${USER} input
